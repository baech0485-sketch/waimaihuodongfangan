<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤–å–æ´»åŠ¨æ–¹æ¡ˆç”Ÿæˆå™¨ - å‘ˆå°šç­–åˆ’</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-slate-50 min-h-screen">
    <div class="max-w-xl mx-auto py-12 px-4">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-2xl font-bold text-slate-800">å¤–å–æ´»åŠ¨æ–¹æ¡ˆç”Ÿæˆå™¨</h1>
            <p class="text-slate-500 mt-2">å‘ˆå°šç­–åˆ’ - ä¸“ä¸šå¤–å–ä»£è¿è¥æœåŠ¡å•†</p>
        </div>

        <!-- Form -->
        <div class="bg-white rounded-2xl p-6 shadow-sm border border-slate-200">
            <div class="space-y-6">
                <!-- åº—é“ºåç§° -->
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-2">åº—é“ºåç§°</label>
                    <input type="text" id="storeName"
                        placeholder="ä¾‹å¦‚ï¼šéœ¸ç‹èŒ¶å§¬ï¼ˆæ˜¥ç†™è·¯åº—ï¼‰"
                        class="w-full px-4 py-3 border border-slate-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>

                <!-- å¹³å°é€‰æ‹© -->
                <div>
                    <label class="block text-sm font-medium text-slate-700 mb-3">ç›®æ ‡å¹³å°</label>
                    <div class="grid grid-cols-3 gap-3">
                        <label class="cursor-pointer">
                            <input type="radio" name="platform" value="meituan" checked class="hidden peer">
                            <div class="p-4 border rounded-xl text-center peer-checked:border-yellow-500 peer-checked:bg-yellow-50">
                                <div class="text-2xl mb-1">ğŸŸ¡</div>
                                <div class="text-sm font-medium">ç¾å›¢</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="platform" value="eleme" class="hidden peer">
                            <div class="p-4 border rounded-xl text-center peer-checked:border-blue-500 peer-checked:bg-blue-50">
                                <div class="text-2xl mb-1">ğŸ”µ</div>
                                <div class="text-sm font-medium">é¥¿äº†ä¹ˆ</div>
                            </div>
                        </label>
                        <label class="cursor-pointer">
                            <input type="radio" name="platform" value="both" class="hidden peer">
                            <div class="p-4 border rounded-xl text-center peer-checked:border-indigo-500 peer-checked:bg-indigo-50">
                                <div class="text-2xl mb-1">ğŸŸ£</div>
                                <div class="text-sm font-medium">åŒå¹³å°</div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- ç”ŸæˆæŒ‰é’® -->
                <button onclick="generatePDF()" id="generateBtn"
                    class="w-full py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-xl hover:opacity-90 transition">
                    ç”Ÿæˆå¹¶ä¸‹è½½ PDF
                </button>

                <!-- çŠ¶æ€æç¤º -->
                <div id="status" class="hidden p-4 rounded-xl text-sm"></div>
            </div>
        </div>
    </div>

    <script>
    async function generatePDF() {
        const storeName = document.getElementById('storeName').value.trim();
        const platform = document.querySelector('input[name="platform"]:checked').value;
        const btn = document.getElementById('generateBtn');
        const status = document.getElementById('status');

        if (!storeName) {
            showStatus('è¯·è¾“å…¥åº—é“ºåç§°', 'error');
            return;
        }

        btn.disabled = true;
        btn.textContent = 'æ­£åœ¨ç”Ÿæˆ...';
        status.classList.add('hidden');

        try {
            const response = await fetch('/api/generate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ store_name: storeName, platform: platform })
            });

            if (!response.ok) throw new Error('ç”Ÿæˆå¤±è´¥');

            const blob = await response.blob();
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${storeName}_æ´»åŠ¨æ–¹æ¡ˆ.pdf`;
            a.click();
            URL.revokeObjectURL(url);

            showStatus('PDF å·²ç”Ÿæˆå¹¶å¼€å§‹ä¸‹è½½', 'success');
        } catch (err) {
            showStatus('ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
        } finally {
            btn.disabled = false;
            btn.textContent = 'ç”Ÿæˆå¹¶ä¸‹è½½ PDF';
        }
    }

    function showStatus(msg, type) {
        const status = document.getElementById('status');
        status.textContent = msg;
        status.className = 'p-4 rounded-xl text-sm ' +
            (type === 'error' ? 'bg-red-50 text-red-600' : 'bg-green-50 text-green-600');
        status.classList.remove('hidden');
    }
    </script>
</body>
</html>
